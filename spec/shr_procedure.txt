Grammar:		DataElement 5.0
Namespace:		shr.procedure
Description:	"The procedure domain contains contexts, topics, and statements related to procedures."
Uses:  			shr.core, shr.base, shr.entity

CodeSystem:		OBSCAT = http://hl7.org/fhir/observation-category


EntryElement:	ProcedurePerformed
Based on:		ActionPerformed
Description:	"A procedure that has been performed."
1..1			ProcedureCode from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			AnatomicalLocation
0..1			PartOf value is type ref(ProcedurePerformed)
0..1			Category  // this is a constraint on the cardinality of Action.Category
0..*			Annotation
0..1			Reason
0..1			Method
//0..*			Precondition
0..*			InputFinding
0..*			Indication
0..*			ref(Device)
0..1			Location
				Participation.OnBehalfOf value is type ref(Organization)
				Status must be from http://hl7.org/fhir/ValueSet/event-status
//				Participation.Participant.EntityOrRole is type ref(Practitioner)
				Participation.Participant is type FHIRProcedureParticipant
				RelatedRequest value is type ref(ProcedureRequested)
0..*			OutputFinding // in CIMI, this is part of ProcedureTopic, but the definition hinges on performance, so it belongs here, not there.

		Element:		ProcedureCode
		Concept:		TBD
		Description:	"A code representing the procedure (not) requested or (not) performed."
		Value:			CodeableConcept

		Element:		InputFinding
		Description:	"Patient findings expected for the performance of the specified procedure. For instance, an x-ray of a fracture prior to a surgical procedure for a bone fracture."
		Value:			ref(Observation)

		Element:		Indication
		Description:	"Conditions or situations where the procedure is recommended. In the Performed context, the actual indication should be reported."
		Value:			CodeableConcept	

		Element:		FHIRProcedureParticipant
		Based on:		Participant
		Description:	"Constraints participants to classes that are accepted by FHIR as actors in procedures in STU 3."
		Value:			ref(Practitioner) or ref(Organization) or ref(Patient) or ref(RelatedPerson) or ref(Device)

		Element:		OutputFinding
		Description:	"Patient findings documented during the performance of the procedure."
		Value:			ref(Finding)


EntryElement:	ProcedureNotPerformed
Based on:		ActionNotPerformed				
0..1			Reason  // limit to 0..1 to match FHIR Procedure.notDoneReason
1..1			ProcedureCode from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			AnatomicalLocation
//0..1			PartOf value is type ref(ProcedurePerformed) ???
0..1			Category  // this is a constraint on the cardinality of Action.Category
0..*			Annotation
1..1			Status must be from http://hl7.org/fhir/ValueSet/event-status
				RelatedRequest value is type ref(ProcedureRequested)

EntryElement:	ProcedureRequested
Based on:		ActionRequested
				PriorityRank must be from http://hl7.org/fhir/ValueSet/request-priority  // required
				Status must be from http://hl7.org/fhir/ValueSet/request-status
1..1			ProcedureCode from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			AnatomicalLocation
0..1			PartOf value is type ref(ProcedurePerformed)
0..1			Category  // this is a constraint on the cardinality of Action.Category
0..*			Annotation
0..1			Reason
0..1			Method
//0..*			Precondition
0..*			InputFinding
0..*			Indication
0..*			ref(Device)
0..1			Location

EntryElement:	ProcedureRequestedAgainst
Based on:		ActionRequestedAgainst
1..1			ProcedureCode from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			AnatomicalLocation



//---------- Specialized Types of Procedure Topics ----------------

EntryElement:	ImagingProcedurePerformed
Based on:		ProcedurePerformed
Concept:		TBD
Description:	"Experimental class for an imaging procedure. This class is still incomplete at this time."
0..*			ImagingSubstance

	Element:		ImagingSubstance
	Concept:		TBD
	Description:	"Substance used for this imaging procedure such as a contrast agent."
	Value:			CodeableConcept


EntryElement:	LaboratoryProcedurePerformed
Based on:		ProcedurePerformed
Concept:		MTH#C0456984
Description:	"A procedure performed on a collected specimen such as a blood panel or a biopsy."
1..1			ProcedureCode from http://hl7.org/fhir/ValueSet/observation-codes
				Category is OBSCAT#laboratory
0..1			ref(Specimen)
//0..1 			ref(Device)   // constraint from 0..*


EntryElement:	SurgicalProcedurePerformed
Based on:		ProcedurePerformed
Concept:		TBD
Description:	"A surgical action, independent of action context."
				ProcedureCode from SurgicalProcedureVS
0..*			DirectSite
0..*			DirectSiteCode
0..*			IndirectSite
0..*			IndirectSiteCode
0..*			SurgicalApproach
0..*			Access
0..*			UsingDevice
0..*			UsingDeviceCode
0..*			UsingAccessDevice
0..*			UsingAccessDeviceCode
0..*			IndirectDevice
0..*			IndirectDeviceCode

		Element:		DirectSite
		Description:	"The site where the procedure is performed."
		Value:			AnatomicalLocation

		Element:		DirectSiteCode
		Description:	"The site where the procedure is performed."
		Value:			CodeableConcept

		Element:		IndirectSite	
		Description:	"The indirect site for this procedure."
		Value:			AnatomicalLocation

		Element:		IndirectSiteCode
		Description:	"The indirect site for this procedure."
		Value:			CodeableConcept

		Element:		SurgicalApproach
		Description:	"The technique used to reach the site of the procedure. Approaches may be through the skin or mucous membrane, through an orifice or external."
		Value:			CodeableConcept

		Element:		Access
		Description:	"The route used to access the site of a procedure. It is used to distinguish open, closed, and percutaneous procedures."
		Value:			CodeableConcept

		Element:		UsingDevice
		Description:	"The device used to perform the procedure."
		Value:			Device

		Element:		UsingDeviceCode
		Description:	"The device used to perform the procedure."
		Value:			CodeableConcept

		Element:		UsingAccessDevice
		Description:	"The access device used to perform the procedure."
		Value:			Device

		Element:		UsingAccessDeviceCode
		Description:	"The access device used to perform the procedure."
		Value:			CodeableConcept

		Element:		IndirectDevice
		Description:	"An indirect device used for this procedure."
		Value:			Device

		Element:		IndirectDeviceCode
		Description:	"An indirect device used for this procedure."
		Value:			CodeableConcept

Element:		SpecimenCollectionPerformed
Based on:		ProcedurePerformed
Description:	"Base class for actions related to the collection of a specimen."
0..*			AmountOrSize
0..1			AnatomicalLocation

	Element:		AmountOrSize
	Description:	"The quantity of specimen collected"
	Value:			SimpleQuantity


EntryElement:   DiagnosticImagingPerformed
Based on:       ProcedurePerformed
Description:    "Diagnostic imaging procedure performed."
Concept:        SCT#363679005 "Imaging (procedure)"  
//              SpecificFocusOfFinding value is type Patient
                ProcedureCode from DiagnosticImagingVS
 
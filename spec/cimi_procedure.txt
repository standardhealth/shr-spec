Grammar:		DataElement 5.0
Namespace:		cimi.procedure
Description:	"The CIMI procedure domain contains contexts, topics, and statements related to procedures."
Uses:  			shr.core, shr.base, cimi.core, cimi.element, cimi.context, cimi.topic, cimi.statement, cimi.entity

CodeSystem:		OBSCAT = http://hl7.org/fhir/observation-category


Element:		ProcedureTopic
Based on:		ActionTopic
Concept:		TBD
Description:	"Description of a healthcare procedure, independent of action context. This can be a physical intervention like an operation, or less invasive like counseling or hypnotherapy."
1..1			TopicCode from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			AnatomicalLocation
0..1			PartOf value is type ref(ProcedurePerformedStatement)
0..1			Category  // this is a constraint on the cardinality of Action.Category
0..*			Annotation
0..1			Reason
0..1			Method
0..*			Precondition
0..*			InputFinding
0..*			Indication
0..*			ref(Device)
0..1			Location

		Element:		InputFinding
		Description:	"Patient findings expected for the performance of the specified procedure. For instance, an x-ray of a fracture prior to a surgical procedure for a bone fracture."
		Value:			ref(FindingStatement)

		Element:		Indication
		Description:	"Conditions or situations where the procedure is recommended. In the Performed context, the actual indication should be reported."
		Value:			CodeableConcept


//---------- Specialized Types of Procedure Topics ----------------

Element:		ImagingProcedureTopic
Based on:		ProcedureTopic
Concept:		TBD
Description:	"Experimental class for an imaging procedure. This class is still incomplete at this time."
0..*			ImagingSubstance

	Element:		ImagingSubstance
	Concept:		TBD
	Description:	"Substance used for this imaging procedure such as a contrast agent."
	Value:			CodeableConcept

Element:		LaboratoryProcedureTopic
Based on:		ProcedureTopic
Concept:		MTH#C0456984
Description:	"A procedure performed on a collected specimen such as a blood panel or a biopsy."
1..1			TopicCode from http://hl7.org/fhir/ValueSet/observation-codes
				Category is OBSCAT#laboratory
0..1			ref(Specimen)
//0..1 			ref(Device)   // constraint from 0..*

	
Element:		SurgicalProcedureTopic
Based on:		ProcedureTopic
Concept:		TBD
Description:	"A surgical action, independent of action context."
0..*			DirectSite
0..*			DirectSiteCode
0..*			IndirectSite
0..*			IndirectSiteCode
0..*			SurgicalApproach
0..*			Access
0..*			UsingDevice
0..*			UsingDeviceCode
0..*			UsingAccessDevice
0..*			UsingAccessDeviceCode
0..*			IndirectDevice
0..*			IndirectDeviceCode

		Element:		DirectSite
		Description:	"The site where the procedure is performed."
		Value:			AnatomicalLocation

		Element:		DirectSiteCode
		Description:	"The site where the procedure is performed."
		Value:			CodeableConcept

		Element:		IndirectSite	
		Description:	"The indirect site for this procedure."
		Value:			AnatomicalLocation

		Element:		IndirectSiteCode
		Description:	"The indirect site for this procedure."
		Value:			CodeableConcept

		Element:		SurgicalApproach
		Description:	"The technique used to reach the site of the procedure. Approaches may be through the skin or mucous membrane, through an orifice or external."
		Value:			CodeableConcept

		Element:		Access
		Description:	"The route used to access the site of a procedure. It is used to distinguish open, closed, and percutaneous procedures."
		Value:			CodeableConcept

		Element:		UsingDevice
		Description:	"The device used to perform the procedure."
		Value:			Device

		Element:		UsingDeviceCode
		Description:	"The device used to perform the procedure."
		Value:			CodeableConcept

		Element:		UsingAccessDevice
		Description:	"The access device used to perform the procedure."
		Value:			Device

		Element:		UsingAccessDeviceCode
		Description:	"The access device used to perform the procedure."
		Value:			CodeableConcept

		Element:		IndirectDevice
		Description:	"An indirect device used for this procedure."
		Value:			Device

		Element:		IndirectDeviceCode
		Description:	"An indirect device used for this procedure."
		Value:			CodeableConcept

Element:		SpecimenCollectionTopic
Based on:		ProcedureTopic
Description:	"Base class for actions related to the collection of a specimen, independent of context."
0..*			AmountOrSize

	Element:		AmountOrSize
	Description:	"The quantity of specimen collected"
	Value:			SimpleQuantity	

//  Specialized Contexts for Procedures

Element:		ProcedurePerformedContext
Based on:		PerformedContext
Description:	"The performed context with constraints applicable to procedures."
				Participant.OnBehalfOf value is type ref(Organization)
				Status must be from http://hl7.org/fhir/ValueSet/event-status
//				Participant.EntityOrRole is type ref(Practitioner)
				Participant is type FHIRProcedureParticipant
				RelatedRequest value is type ref(ProcedureRequestedStatement)
0..*			OutputFinding // in CIMI, this is part of ProcedureTopic, but the definition hinges on performance, so it belongs here, not there.	

		Element:		FHIRProcedureParticipant
		Based on:		Participant
		Description:	"Constraints participants to classes that are accepted by FHIR as actors in procedures."
		Value:			ref(Practitioner) or ref(Organization) or ref(Patient) or ref(RelatedPerson) or ref(Device)

		Element:		OutputFinding
		Description:	"Patient findings documented during the performance of the procedure."
		Value:			ref(FindingStatement)

Element:		ProcedureNotPerformedContext
Based on:		NotPerformedContext
Description:	"The not performed context with constraints applicable to procedures, namely, the request must be a procedure request."
				RelatedRequest value is type ref(ProcedureRequestedStatement)

Element:		ProcedureRequestedContext
Based on:		RequestedContext
Description:	"The requested context with additional constraints applicable to procedures."
				PriorityRank must be from http://hl7.org/fhir/ValueSet/request-priority  // required
				Status must be from http://hl7.org/fhir/ValueSet/request-status
	
// Statements derived from Procedure Topics and Contexts

EntryElement:	ProcedurePerformedStatement
Based on:		ActionPerformedStatement
1..1			SubjectOfInformation value is type ref(Patient)
				StatementTopic is type ProcedureTopic
				StatementContext is type ProcedurePerformedContext

EntryElement:	ProcedureNotPerformedStatement
Based on:		ActionNotPerformedStatement
1..1			SubjectOfInformation value is type ref(Patient)
				StatementTopic is type ProcedureTopic
				StatementContext is type ProcedureNotPerformedContext
0..1			ProcedureNotPerformedContext.Reason  // limit to 0..1 to match FHIR Procedure.notDoneReason

EntryElement:	ProcedureRequestedStatement
Based on:		ActionRequestedStatement
1..1			SubjectOfInformation value is type ref(Patient)
				StatementTopic is type ProcedureTopic
				StatementContext is type ProcedureRequestedContext

EntryElement:	ProcedureRequestedAgainstStatement
Based on:		ActionRequestedAgainstStatement
1..1			SubjectOfInformation value is type ref(Patient)
				StatementTopic is type ProcedureTopic
				StatementContext is type RequestedAgainstContext				

EntryElement:	SpecimenCollectionPerformedStatement
Based on:		ProcedurePerformedStatement
				StatementTopic is type SpecimenCollectionTopic
0..1			AnatomicalLocation  // FHIR limits Specimen.collection.bodySite to 0..1

EntryElement:	SpecimenCollectionRequestedStatement
Based on:		ProcedureRequestedStatement
				StatementTopic is type SpecimenCollectionTopic
			
EntryElement:	ImagingProcedurePerformedStatement
Based on:		ProcedurePerformedStatement
				StatementTopic is type ImagingProcedureTopic

EntryElement:	ImagingProcedureRequestedStatement
Based on:		ProcedureRequestedStatement
				StatementTopic is type ImagingProcedureTopic

EntryElement:	SurgicalProcedurePerformedStatement
Based on:		ProcedurePerformedStatement
				StatementTopic is type SurgicalProcedureTopic

EntryElement:	SurgicalProcedureRequestedStatement
Based on:		ProcedureRequestedStatement
				StatementTopic is type SurgicalProcedureTopic

EntryElement:	SurgicalProcedureNotPerformedStatement
Based on:		ProcedureNotPerformedStatement
				StatementTopic is type SurgicalProcedureTopic

EntryElement:	SurgicalProcedureRequestedAgainstStatement
Based on:		ProcedureRequestedAgainstStatement
				StatementTopic is type SurgicalProcedureTopic
		
EntryElement:	LaboratoryProcedurePerformedStatement
Based on:		ProcedurePerformedStatement
				StatementTopic is type LaboratoryProcedureTopic
				
EntryElement:	LaboratoryProcedureRequestedStatement
Based on:		ProcedureRequestedStatement
				StatementTopic is type LaboratoryProcedureTopic
		


